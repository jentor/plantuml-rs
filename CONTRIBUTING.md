# Руководство по участию в проекте

Спасибо за интерес к участию в проекте plantuml-rs! Это руководство поможет вам начать.

## Содержание

- [Кодекс поведения](#кодекс-поведения)
- [Как я могу помочь?](#как-я-могу-помочь)
- [Настройка окружения](#настройка-окружения)
- [Процесс разработки](#процесс-разработки)
- [Стиль кода](#стиль-кода)
- [Отправка изменений](#отправка-изменений)
- [Сообщения коммитов](#сообщения-коммитов)

---

## Кодекс поведения

Этот проект придерживается [Кодекса поведения](CODE_OF_CONDUCT.md). Участвуя в проекте, вы соглашаетесь соблюдать его условия.

---

## Как я могу помочь?

### Сообщить о баге

1. Проверьте, что баг ещё не был зарегистрирован в [Issues](https://github.com/user/plantuml-rs/issues)
2. Создайте новый issue с меткой `bug`
3. Опишите:
   - Ожидаемое поведение
   - Фактическое поведение
   - Шаги для воспроизведения
   - Версия Rust и ОС
   - Минимальный пример PlantUML кода

### Предложить улучшение

1. Создайте issue с меткой `enhancement`
2. Опишите:
   - Какую проблему решает улучшение
   - Предлагаемое решение
   - Альтернативные варианты

### Написать код

1. Найдите issue с меткой `good first issue` для начала
2. Прокомментируйте issue, что вы хотите взяться за него
3. Форкните репозиторий и создайте ветку
4. Напишите код и тесты
5. Отправьте Pull Request

### Улучшить документацию

- Исправить опечатки
- Добавить примеры использования
- Улучшить описания API

---

## Настройка окружения

### Требования

- Rust 1.75+ ([установка](https://rustup.rs/))
- Git

### Клонирование репозитория

```bash
git clone https://github.com/user/plantuml-rs.git
cd plantuml-rs
```

### Сборка

```bash
cargo build --workspace
```

### Запуск тестов

```bash
cargo test --workspace
```

### Проверка WASM сборки

```bash
# Установить target
rustup target add wasm32-unknown-unknown

# Собрать
cargo build --target wasm32-unknown-unknown -p plantuml-wasm
```

---

## Процесс разработки

### Ветки

- `main` — стабильная ветка
- `develop` — ветка разработки
- `feature/*` — новая функциональность
- `fix/*` — исправления багов
- `docs/*` — документация

### Workflow

1. Создайте ветку от `develop`:
   ```bash
   git checkout develop
   git pull origin develop
   git checkout -b feature/my-feature
   ```

2. Разработайте функциональность

3. Убедитесь, что все проверки проходят:
   ```bash
   cargo fmt --all --check
   cargo clippy --workspace -- -D warnings
   cargo test --workspace
   ```

4. Отправьте Pull Request в `develop`

---

## Стиль кода

### Форматирование

Используем стандартный `rustfmt`:

```bash
cargo fmt --all
```

### Линтер

```bash
cargo clippy --workspace -- -D warnings
```

### Документация

- Публичные API должны иметь doc-комментарии на **русском языке**
- Используйте примеры в документации

```rust
/// Парсит PlantUML исходный код и возвращает AST диаграммы.
///
/// # Пример
///
/// ```rust
/// use plantuml_rs::parse;
///
/// let source = "@startuml\nAlice -> Bob\n@enduml";
/// let diagram = parse(source).unwrap();
/// ```
///
/// # Ошибки
///
/// Возвращает `ParseError` если синтаксис некорректен.
pub fn parse(source: &str) -> Result<Diagram, ParseError> {
    // ...
}
```

### Именование

- Используйте `snake_case` для функций и переменных
- Используйте `CamelCase` для типов и трейтов
- Используйте `SCREAMING_SNAKE_CASE` для констант

### Тесты

- Каждый модуль должен иметь unit тесты
- Для новой функциональности добавляйте integration тесты
- Для рендеринга используйте snapshot тесты (insta)

```rust
#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_parse_simple_sequence() {
        let source = "@startuml\nAlice -> Bob: Hello\n@enduml";
        let result = parse(source);
        assert!(result.is_ok());
    }
}
```

---

## Отправка изменений

### Перед отправкой PR

1. Убедитесь, что код форматирован: `cargo fmt --all`
2. Запустите линтер: `cargo clippy --workspace -- -D warnings`
3. Запустите тесты: `cargo test --workspace`
4. Обновите документацию при необходимости
5. Добавьте запись в CHANGELOG.md (в секцию `[Unreleased]`)

### Pull Request

1. Заполните шаблон PR
2. Свяжите с соответствующим issue
3. Опишите изменения
4. Дождитесь code review

### Code Review

- Будьте открыты к обратной связи
- Отвечайте на комментарии
- Вносите запрошенные изменения

---

## Сообщения коммитов

Используем формат [Conventional Commits](https://www.conventionalcommits.org/):

```
<тип>(<область>): <описание>

[тело]

[футер]
```

### Типы

- `feat` — новая функциональность
- `fix` — исправление бага
- `docs` — документация
- `style` — форматирование (не влияет на код)
- `refactor` — рефакторинг кода
- `test` — добавление тестов
- `chore` — обслуживание проекта

### Примеры

```bash
feat(parser): добавлен парсинг sequence diagrams
fix(layout): исправлен расчёт позиции lifeline
docs: обновлена документация API
test(renderer): добавлены тесты для SVG рендеринга
refactor(ast): упрощена структура Diagram enum
```

### Язык

**Все сообщения коммитов на русском языке.**

---

## Вопросы?

Если у вас есть вопросы, создайте issue с меткой `question` или обратитесь к maintainers.

Спасибо за ваш вклад!
